{
  "hash": "790015f37a67692ec4949bc116470481",
  "result": {
    "markdown": "---\ntitle: \"Extracting Cognitive Factors from Large-Scale Meta-Anslysis Data\"\nauthor: [\"Yifei Cao\", \"Liang Zhang\"]\ndate: \"2022-05-10\"\ndraft: false\nformat: \n  html:\n    code-fold: true\n    toc: true\n    toc-location: left\ncategories: [structure, cognition, meta-analysis]\nexecute:\n  warning: false\n---\n\n\n\n\nTo summarize briefly, I followed the step of Beam et al. _(2021, Nature Neuroscience)_ to find evidence for the structure of human cognition. Firstly, filtering all studies that included the testing paradigms that consisted with those used in our project from the database of Neurosynth, I conducted 28 meta-analysis separately on each group of fMRI studies. Thanks to NiMARE _(a python research environment for neuroimaging meta-analysis)_, I could easily perform Multilevel Kernel Density Analysis (MKDA) on hundreds fMRI studies without manually coding.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\"wisconsin.png\")\n```\n\n::: {.cell-output-display}\n![Example Figure1. MKDA result plot for fMRI studies using Wisconsin Card Sorting Games](wisconsin.png){width=266}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\"stroop.png\")\n```\n\n::: {.cell-output-display}\n![Example Figure1. MKDA result plot for fMRI studies using Stroop task](stroop.png){width=258}\n:::\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_9368fbbb57bc41b63e69082efb03ab20'}\n\n```{.r .cell-code}\ncog_label <- readxl::read_xlsx(\"Selected_cogconstruct_label.xlsx\")\nlabel_occur <- readxl::read_xlsx(\"dtm_210114.xlsx\")\n\noccur_combined <- label_occur %>% \n  pivot_longer(cols = -c(\"study_id\"), names_to = \"term_name\", values_to = \"occurrence\") %>% \n  left_join(cog_label, by = \"term_name\") %>% \n  filter(!is.na(meta_name)) %>% \n  group_by(study_id, meta_name) %>% \n  summarize(task_occurrence = sum(occurrence)) %>% \n  filter(task_occurrence > 1)\ntotal_occur <- occur_combined %>% \n  group_by(meta_name) %>% \n  summarize(total_occurrence = length(study_id)) %>% \n  filter(total_occurrence > 16) %>% \n  mutate(Paradigm_name = meta_name,\n         Number_of_studies = total_occurrence) %>% \n  select(Paradigm_name, Number_of_studies) %>% \n  arrange(desc(Number_of_studies))\n```\n:::\n\n\nHere is the summarize table for the number of included fMRI studies in each meta-analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_occur |> \n  htmlTable::htmlTable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >\n<thead>\n<tr><th style='border-bottom: 1px solid grey; border-top: 2px solid grey;'></th>\n<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Paradigm_name</th>\n<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Number_of_studies</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style='text-align: left;'>1</td>\n<td style='text-align: center;'>Stroop_task</td>\n<td style='text-align: center;'>1193</td>\n</tr>\n<tr>\n<td style='text-align: left;'>2</td>\n<td style='text-align: center;'>Go/no_go_task</td>\n<td style='text-align: center;'>752</td>\n</tr>\n<tr>\n<td style='text-align: left;'>3</td>\n<td style='text-align: center;'>N_back_task</td>\n<td style='text-align: center;'>572</td>\n</tr>\n<tr>\n<td style='text-align: left;'>4</td>\n<td style='text-align: center;'>Word_generation_task</td>\n<td style='text-align: center;'>359</td>\n</tr>\n<tr>\n<td style='text-align: left;'>5</td>\n<td style='text-align: center;'>Oddball_task</td>\n<td style='text-align: center;'>203</td>\n</tr>\n<tr>\n<td style='text-align: left;'>6</td>\n<td style='text-align: center;'>Iowa_gambling_task</td>\n<td style='text-align: center;'>201</td>\n</tr>\n<tr>\n<td style='text-align: left;'>7</td>\n<td style='text-align: center;'>Recognition_task</td>\n<td style='text-align: center;'>184</td>\n</tr>\n<tr>\n<td style='text-align: left;'>8</td>\n<td style='text-align: center;'>Wisconsin_card_game</td>\n<td style='text-align: center;'>179</td>\n</tr>\n<tr>\n<td style='text-align: left;'>9</td>\n<td style='text-align: center;'>Anti_saccade_task</td>\n<td style='text-align: center;'>177</td>\n</tr>\n<tr>\n<td style='text-align: left;'>10</td>\n<td style='text-align: center;'>Flanker_task</td>\n<td style='text-align: center;'>170</td>\n</tr>\n<tr>\n<td style='text-align: left;'>11</td>\n<td style='text-align: center;'>Switching_task</td>\n<td style='text-align: center;'>165</td>\n</tr>\n<tr>\n<td style='text-align: left;'>12</td>\n<td style='text-align: center;'>Calculation_task</td>\n<td style='text-align: center;'>151</td>\n</tr>\n<tr>\n<td style='text-align: left;'>13</td>\n<td style='text-align: center;'>Stop_signal_task</td>\n<td style='text-align: center;'>130</td>\n</tr>\n<tr>\n<td style='text-align: left;'>14</td>\n<td style='text-align: center;'>Mental_rotation_task</td>\n<td style='text-align: center;'>117</td>\n</tr>\n<tr>\n<td style='text-align: left;'>15</td>\n<td style='text-align: center;'>Selective_attention_task</td>\n<td style='text-align: center;'>117</td>\n</tr>\n<tr>\n<td style='text-align: left;'>16</td>\n<td style='text-align: center;'>Tower_of_London_task</td>\n<td style='text-align: center;'>103</td>\n</tr>\n<tr>\n<td style='text-align: left;'>17</td>\n<td style='text-align: center;'>Verbal_fluency_task</td>\n<td style='text-align: center;'>86</td>\n</tr>\n<tr>\n<td style='text-align: left;'>18</td>\n<td style='text-align: center;'>Visual_search_task</td>\n<td style='text-align: center;'>85</td>\n</tr>\n<tr>\n<td style='text-align: left;'>19</td>\n<td style='text-align: center;'>Auditory_discrimination_task</td>\n<td style='text-align: center;'>84</td>\n</tr>\n<tr>\n<td style='text-align: left;'>20</td>\n<td style='text-align: center;'>Continuous_performance_task</td>\n<td style='text-align: center;'>83</td>\n</tr>\n<tr>\n<td style='text-align: left;'>21</td>\n<td style='text-align: center;'>Simon_task</td>\n<td style='text-align: center;'>82</td>\n</tr>\n<tr>\n<td style='text-align: left;'>22</td>\n<td style='text-align: center;'>Choice_reaction_time_task</td>\n<td style='text-align: center;'>74</td>\n</tr>\n<tr>\n<td style='text-align: left;'>23</td>\n<td style='text-align: center;'>Reasoning_task</td>\n<td style='text-align: center;'>61</td>\n</tr>\n<tr>\n<td style='text-align: left;'>24</td>\n<td style='text-align: center;'>Delay_memory_task</td>\n<td style='text-align: center;'>51</td>\n</tr>\n<tr>\n<td style='text-align: left;'>25</td>\n<td style='text-align: center;'>Orientation_match_task</td>\n<td style='text-align: center;'>28</td>\n</tr>\n<tr>\n<td style='text-align: left;'>26</td>\n<td style='text-align: center;'>Trial_making_test</td>\n<td style='text-align: center;'>28</td>\n</tr>\n<tr>\n<td style='text-align: left;'>27</td>\n<td style='text-align: center;'>Forward_span_task</td>\n<td style='text-align: center;'>25</td>\n</tr>\n<tr>\n<td style='text-align: left;'>28</td>\n<td style='text-align: center;'>Complex_span_task</td>\n<td style='text-align: center;'>20</td>\n</tr>\n<tr>\n<td style='border-bottom: 2px solid grey; text-align: left;'>29</td>\n<td style='border-bottom: 2px solid grey; text-align: center;'>Simple_reaction_time_task</td>\n<td style='border-bottom: 2px solid grey; text-align: center;'>17</td>\n</tr>\n</tbody>\n</table>\n`````\n:::\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-6_79bc5cf0c5e3293b1e5ca40163aded27'}\n\n```{.r .cell-code}\ntotal_matrix <- fs::dir_ls(\"data\", regexp = \"xlsx\") %>% \n  map(readxl::read_xlsx, col_names = TRUE) %>% \n  reduce(left_join, by = \"voxel_num\")\n```\n:::\n\n\n# Correlation Matrix\nHere is the representational similarity matrix of the 28 meta-analysis results, representing the similarity of the brain activities during these 28 different types of cognitive tasks.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_nonzero <- total_matrix[which(rowSums(total_matrix) > 0),] %>% \n  select(-voxel_num)\ncor_total <- round(cor(total_matrix),2)\ncor_nonzero <- round(cor(total_nonzero),2)\nmelted_cor_nonzero <- melt(cor_nonzero) %>% \n mutate(percrank=rank(value)/length(value))\n\ncorrelate(total_nonzero, quiet = TRUE) |>\n  rearrange(method = \"HC\") |>\n  stretch() |>\n  mutate(across(c(x, y), as_factor)) |>\n  ggplot(aes(x, y)) +\n  geom_tile(aes(fill = r)) +\n  scico::scale_fill_scico(palette = \"bam\", midpoint = 0, direction = -1) +\n  coord_fixed() +\n  theme_minimal(base_size = 18) +\n  labs(x = \"\", y = \"\", fill = \"Pearson's\", color = \"\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=960}\n:::\n\n```{.r .cell-code}\n# ggplot(data = melted_cor_nonzero, aes(Var2, Var1, fill = percrank))+\n#  geom_tile(color = \"black\")+\n#   scale_fill_viridis(discrete=FALSE)+\n#   theme_minimal()+ \n#  theme(axis.text.x = element_text(angle = 45, vjust = 1, \n#     size = 7, hjust = 1),\n#     axis.text.y = element_text(size = 7))+\n#  coord_fixed()\n```\n:::\n\n\n# Multidimensional Scaling\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmds <- total_nonzero |> \n  cor(use = \"pairwise\") |> \n  smacof::sim2diss(to.dist = TRUE) |> \n  smacof::mds(ndim = 2, type = \"mspline\")\n# plot(mds, plot.type = \"Shepard\", main = \"Shepard Diagram (Ratio Transformation)\")\n# par(family = \"SimHei\")\nplot(mds)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n# Exploratory Factor Analysis\n\n## Traditional\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnfactors_test <- psych::nfactors(cor_nonzero)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n* Correlated latent factors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- psych::fa(cor_nonzero, 4)\npsych::fa.diagram(fit)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n* Bifactor model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_bifac <- psych::omega(total_nonzero, 3, plot = FALSE)\npsych::omega.diagram(fit_bifac)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}